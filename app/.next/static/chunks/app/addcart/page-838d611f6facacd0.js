(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[363],{2700:function(t,e,l){Promise.resolve().then(l.bind(l,9318))},9318:function(t,e,l){"use strict";var r=l(7437),a=l(8472),c=l(6463),s=l(2265),d=l(7138);e.default=()=>{let{pId:t}=(0,c.useParams)(),[e,l]=(0,s.useState)([]),[o,n]=(0,s.useState)(0),[i,u]=(0,s.useState)(null),[p,x]=(0,s.useState)(1),h=t=>{try{let[e,l]=t.split("."),r=atob(l);return JSON.parse(r)}catch(t){return console.error("Error decoding JWT token:",t.message),null}},m=async()=>{let t=h(localStorage.getItem("jwt")||"");try{let e=await a.Z.get("".concat("http://localhost:5000","/api/cart/getcart/").concat(t.userId));localStorage.setItem("count",null==e?void 0:e.data.length),l(e.data)}catch(t){console.error("Error fetching product by ID:",t)}};(0,s.useEffect)(()=>{m()},[]),(0,s.useEffect)(()=>{n(e.map(t=>{var e;return(null===(e=t.product)||void 0===e?void 0:e.price)*t.totalQuantity}).reduce((t,e)=>t+e,0))},[e]);let f=async t=>{let r=h(localStorage.getItem("jwt")||"");try{await a.Z.delete("".concat("http://localhost:5000","/api/cart/cart/").concat(r.userId,"/").concat(t)),l(e.filter(e=>e.product._id!==t))}catch(t){console.error("Error deleting product from cart:",t)}},v=t=>{u(t);let l=e.find(e=>{var l;return(null===(l=e.product)||void 0===l?void 0:l._id)===t});x(l?l.totalQuantity:1)},y=async t=>{if(p<1){alert("Quantity must be at least 1");return}try{let r=h(localStorage.getItem("jwt")||"");await a.Z.put("".concat("http://localhost:5000","/api/cart/cart/").concat(r.userId,"/").concat(t),{quantity:p}),l(e.map(e=>(e.product._id===t&&(e.totalQuantity=p),e))),u(null)}catch(t){console.error("Error updating product quantity:",t)}};return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("section",{className:"py-8 pt-[100px] min-h-screen w-full lg:flex lg:justify-center overflow-x-auto bg-[#060B27] max-w-full",children:(0,r.jsx)("div",{className:"  ",children:(0,r.jsxs)("div",{className:"flex flex-col  justify-center lg:w-full  p-5 ",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-4 text-left sticky text-white",children:"Cart"}),(0,r.jsx)("div",{children:e.length>0?(0,r.jsx)("div",{className:"  text-white",children:(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"border border-white rounded-lg lg:w-full min-w-max",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"pl-5 py-5 text-left",children:"Image"}),(0,r.jsx)("th",{className:"px-2 py-2  text-left",children:"Name"}),(0,r.jsx)("th",{className:"px-2 py-2  text-left",children:"Description"}),(0,r.jsx)("th",{className:"px-2 py-2  text-left",children:"Price"}),(0,r.jsx)("th",{className:"px-2 py-2  text-left",children:"Quantity"}),(0,r.jsx)("th",{className:"px-2 py-2  text-left",children:"Total"}),(0,r.jsx)("th",{className:"px-2 py-2  text-left",children:"Action"})]})}),(0,r.jsxs)("tbody",{children:[e.map(t=>{var e,l,a,c,s,d,o,n,u;return(0,r.jsxs)("tr",{className:"border-t border-gray-200",children:[(0,r.jsx)("td",{className:"py-2 pl-5 text-left flex justify-start",children:(0,r.jsx)("img",{src:null===(e=t.product)||void 0===e?void 0:e.url,alt:null===(l=t.product)||void 0===l?void 0:l.name,className:"h-16 w-18 object-cover rounded"})}),(0,r.jsx)("td",{className:"px-2  text-left py-2",children:null===(a=t.product)||void 0===a?void 0:a.name}),(0,r.jsx)("td",{className:"px-2  text-left py-2",children:null===(c=t.product)||void 0===c?void 0:c.description}),(0,r.jsxs)("td",{className:"px-2 text-left py-2",children:["$",null===(s=t.product)||void 0===s?void 0:s.price]}),(0,r.jsx)("td",{className:"px-2  text-left py-2",children:i===(null===(d=t.product)||void 0===d?void 0:d._id)?(0,r.jsx)("input",{type:"number",value:p,onChange:t=>x(Math.max(1,Number(t.target.value))),className:"border rounded px-2 py-1 w-16"}):t.totalQuantity}),(0,r.jsxs)("td",{className:"px-2  text-left py-2",children:["$",(null===(o=t.product)||void 0===o?void 0:o.price)*t.totalQuantity]}),(0,r.jsxs)("td",{className:"px-2 flex text-left py-2",children:[i===(null===(n=t.product)||void 0===n?void 0:n._id)?(0,r.jsx)("button",{onClick:()=>{var e;return y(null===(e=t.product)||void 0===e?void 0:e._id)},className:"bg-green-500 hover:bg-green-700 text-white font-bold py-1 px-2 rounded",children:"Update"}):(0,r.jsx)("button",{onClick:()=>{var e;return v(null===(e=t.product)||void 0===e?void 0:e._id)},className:"bg-green-500 hover:bg-green-700 text-white font-bold py-1 px-1 rounded",children:"Edit"}),(0,r.jsx)("button",{onClick:()=>{var e;return f(null===(e=t.product)||void 0===e?void 0:e._id)},className:"bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-1 rounded ml-2",children:"Delete"})]})]},null===(u=t.product)||void 0===u?void 0:u._id)}),(0,r.jsxs)("tr",{className:"border-t border-gray-600",children:[(0,r.jsx)("td",{className:"px-2 py-2"}),(0,r.jsx)("td",{className:"px-2 py-2"}),(0,r.jsx)("td",{className:"px-2 py-2 font-bold",children:"Total:"}),(0,r.jsxs)("td",{className:"px-2 py-2 font-bold",children:["$",o]}),(0,r.jsx)("td",{className:"px-2 py-2 gap-11",children:(0,r.jsx)(d.default,{href:"",passHref:!0,children:(0,r.jsx)("button",{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-1 px-2 rounded ml-2",children:"Connect Wallet"})})})]})]})]})})}):(0,r.jsx)("p",{className:"mt-4 text-white",children:"No products in the cart."})})]})})})})}}},function(t){t.O(0,[472,291,971,23,744],function(){return t(t.s=2700)}),_N_E=t.O()}]);